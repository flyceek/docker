FROM flyceek/centos7-jdk:latest
MAINTAINER flyceek <flyceek@gmail.com>

ARG ACTIVEMQ_VERSION=5.13.0
ARG ACTIVEMQ_EXTRACT_DIR=apache-activemq-${ACTIVEMQ_VERSION}
ARG ACTIVEMQ_FILE_NAME=${ACTIVEMQ_EXTRACT_DIR}-bin.tar.gz
ARG ACTIVEMQ_FILE_URL=https://archive.apache.org/dist/activemq/${ACTIVEMQ_VERSION}/${ACTIVEMQ_FILE_NAME}

ENV ACTIVEMQ_TCP=61616 ACTIVEMQ_AMQP=5672 ACTIVEMQ_STOMP=61613 ACTIVEMQ_MQTT=1883 ACTIVEMQ_WS=61614 ACTIVEMQ_UI=8161
ENV ACTIVEMQ_WORK_HOME=/opt/sfot/activemq
ENV ACTIVEMQ_HOME=${ACTIVEMQ_WORK_HOME}/${ACTIVEMQ_EXTRACT_DIR}

RUN set -x && \
    mkdir -p ${ACTIVEMQ_HOME} && \
    cd ${ACTIVEMQ_WORK_HOME} && \
    curl -S ${ACTIVEMQ_FILE_URL} | tar xvz -C ${ACTIVEMQ_WORK_HOME}

WORKDIR ${ACTIVEMQ_HOME}
EXPOSE ${ACTIVEMQ_TCP} ${ACTIVEMQ_AMQP} ${ACTIVEMQ_STOMP} ${ACTIVEMQ_MQTT} ${ACTIVEMQ_WS} ${ACTIVEMQ_UI}
CMD ["/bin/sh", "-c", "bin/activemq console"]